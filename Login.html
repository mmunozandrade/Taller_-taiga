<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
        <!-- Brand -->
        <a class="navbar-brand d-flex align-items-center" href="Inicio.html">
            <h2 class="mb-0">Meniaterránia</h2>
        </a>
        <div class="d-flex align-items-center">
            <a href="Inicio.html" class="nav-link text-white me-4 fw-semibold">
                <i class="bi bi-house-door-fill me-1"></i> Inicio
            </a>

            <a href="Carrito.html" class="nav-link text-white me-4 fw-semibold">
                <i class="bi bi-book-half me-1"></i> Menú
            </a>
            <a href="CarritoPago.html" class="nav-link text-white position-relative">
                <i class="bi bi-cart3" style="font-size:1.5rem;">Carrito</i>
                <span id="cart-count"
                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                0
                </span>
            </a>
            <a href="Perfil.html" class="nav-link text-white me-3">
                <i class="bi bi-person-circle" style="font-size:1.5rem;">Perfil</i>
            </a>
            <a href="DatosCifrados.html" class="nav-link text-white me-4 fw-semibold">
                <i class="bi bi-book-half me-1"></i> Empleados
            </a>
            </div>
        </div>
    </nav>
    <div class="container py-5">
        <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-sm">
            <div class="card-body">
                <h1 class="card-title">Iniciar Sesión</h1> 
                <button type="button" class="btn btn-primary w-100 mb-3" style="background-color: #1877F2; border-color: #1877F2;" onclick="loginFacebook()">
                <i class="fab fa-facebook me-2"></i> Iniciar Sesión con Facebook
                </button> 
                <div class="text-center text-muted mb-12">O</div> 
                            <form onsubmit="return manejarInicioSesion(event)">  <div class="mb-3">
                <h1 class="card-body">Ingresar con Correo</h1>
                <label for="email" class="form-label">Usuario</label>
                    <input type="email" class="form-control" id="email" placeholder="ana@example.com" required>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" class="form-control" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary w-100">Ingresar</button>  </form>
            </div>
            </div>
        </div>
            <div id="alerta-exito" class="alert alert-success mt-4 d-none">
            <strong>Ingreso exitoso:</strong> Redirigiendo a la página principal.
            </div>
        <div id="alerta-error" class="alert alert-danger mt-4 d-none">
            <strong>Error de credenciales:</strong> Usuario o contraseña incorrectos.
        </div>
        <div id="alerta-facebook" class="alert alert-info mt-4 d-none">
            <strong>Facebook:</strong> Conectando con Facebook...
        </div>
        </div>
        </div>

    <script>
    function manejarInicioSesion(event) {
        event.preventDefault();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        
        // Cuentas de prueba para el frontend
        const cuentasCliente = [
            { correo: "cliente1@gmail.com", pass: "1234" },
            { correo: "cliente2@gmail.com", pass: "1234" },
            { correo: "cliente3@gmail.com", pass: "1234" },
            { correo: "cliente4@gmail.com", pass: "1234" },
            { correo: "cliente5@gmail.com", pass: "1234" }
        ];
        const clienteEncontrado = cuentasCliente.find(cliente => 
            cliente.correo === email && cliente.pass === password
        );
        if (clienteEncontrado) {
            console.log("Login local exitoso. Saltando llamada a la API.");
            localStorage.setItem('authToken', 'TOKEN_DE_PRUEBA_LOCAL_123456'); 
            mostrarAlerta('alerta-exito');
            setTimeout(() => { 
                window.location.href = 'Inicio.html'; 
            }, 1500); 
            return false;
        }
        const apiUrl = 'URL_BASE_DE_TU_API/api/v1/auth/login'; 
        const options = {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                email: email, 
                password: password
            })
        };
        fetch(apiUrl, options)
            .then(response => {
                if (!response.ok) {
                    mostrarAlerta('alerta-error');
                    throw new Error('Error de la API o credenciales incorrectas'); 
                }
                return response.json();
            })
            .then(data => {
                if (data && data.token) {
                    localStorage.setItem('authToken', data.token); 
                }
                mostrarAlerta('alerta-exito');
                
                setTimeout(() => { 
                    window.location.href = 'Inicio.html'; 
                }, 1500); 
            })
            .catch(error => {
                console.error('Error de conexión o autenticación:', error);
                mostrarAlerta('alerta-error');
            });
            
        return false;
    }
    function mostrarAlerta(idAlerta) {
        document.querySelectorAll('.alert').forEach(alert => {
            alert.classList.add('d-none');
        });
        const alerta = document.getElementById(idAlerta);
        if(alerta) {
            alerta.classList.remove('d-none');
        }
    }
    function loginFacebook() {
        mostrarAlerta('alerta-facebook');
    }
</script>
</body>
</html>
